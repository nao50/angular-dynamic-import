{"ast":null,"code":"import _asyncToGenerator from \"/Users/nao/nodejs/angular-dynamic-import/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { ViewContainerRef } from '@angular/core';\nimport { BlueComponent } from './blue/blue.component';\nimport { RedComponent } from './red/red.component';\nimport { YellowComponent } from './yellow/yellow.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/widget.service\";\nimport * as i2 from \"@angular/router\";\nconst _c0 = [\"dynamic\"];\nexport class AppComponent {\n  constructor(widgetService, resolver) {\n    this.widgetService = widgetService;\n    this.resolver = resolver;\n  }\n\n  ngOnInit() {\n    this.listWidgets(); // const aaa = this.loadDynamicComponent('blue');\n    // console.log('aaa:', aaa)\n\n    this.blueFactory = this.resolver.resolveComponentFactory(BlueComponent);\n    this.redFactory = this.resolver.resolveComponentFactory(RedComponent);\n    this.yellowFactory = this.resolver.resolveComponentFactory(YellowComponent);\n  }\n\n  listWidgets() {\n    this.widgetService.listWidgets('assets/widgets.json').subscribe(data => {\n      console.log(data);\n    });\n  }\n\n  loadDynamicComponentWithComponentFactoryResolver(type) {\n    switch (type) {\n      case \"blue\":\n        this.viewContainerRef.createComponent(this.blueFactory);\n        break;\n\n      case \"red\":\n        this.viewContainerRef.createComponent(this.redFactory);\n        break;\n\n      case \"yellow\":\n        this.viewContainerRef.createComponent(this.yellowFactory);\n        break;\n\n      default:\n        return;\n    }\n  } // loadDynamicComponent(type: string): any {\n\n\n  loadDynamicComponent(type) {\n    return _asyncToGenerator(function* () {\n      // const widgetModule = await import(`./${type}/${type}.module`)\n      // return new widgetModule.BlueModule.BlueComponent\n      // const widgetModule = await import(`./blue/blue.module`)\n      const widgetModule = yield import(`./blue/blue.component`);\n      const hoge = new widgetModule.BlueComponent();\n    })();\n  }\n\n}\n\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.WidgetService), i0.ɵɵdirectiveInject(i0.ComponentFactoryResolver));\n};\n\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  viewQuery: function AppComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5, ViewContainerRef);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.viewContainerRef = _t.first);\n    }\n  },\n  decls: 13,\n  vars: 0,\n  consts: [[1, \"m-24\", \"flex\", \"flex-wrap\", \"gap-x-2\", \"justify-center\"], [1, \"py-2\", \"px-4\", \"border\", \"border-transparent\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"rounded-md\", \"text-white\", \"bg-gray-500\", \"hover:bg-gray-700\", 3, \"click\"], [1, \"py-2\", \"px-4\", \"border\", \"border-transparent\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"rounded-md\", \"text-white\", \"bg-blue-400\", \"hover:bg-blue-600\", 3, \"click\"], [1, \"py-2\", \"px-4\", \"border\", \"border-transparent\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"rounded-md\", \"text-white\", \"bg-yellow-400\", \"hover:bg-yellow-600\", 3, \"click\"], [1, \"py-2\", \"px-4\", \"border\", \"border-transparent\", \"shadow-sm\", \"text-sm\", \"font-medium\", \"rounded-md\", \"text-white\", \"bg-red-400\", \"hover:bg-red-600\", 3, \"click\"], [\"dynamic\", \"\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"button\", 1);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_1_listener() {\n        return ctx.loadDynamicComponent(\"blue\");\n      });\n      i0.ɵɵtext(2, \" Add Random Component \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 0);\n      i0.ɵɵelementStart(4, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_4_listener() {\n        return ctx.loadDynamicComponentWithComponentFactoryResolver(\"blue\");\n      });\n      i0.ɵɵtext(5, \" Add Blue Component \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"button\", 3);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_6_listener() {\n        return ctx.loadDynamicComponentWithComponentFactoryResolver(\"yellow\");\n      });\n      i0.ɵɵtext(7, \" Add Yellow Component \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"button\", 4);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_8_listener() {\n        return ctx.loadDynamicComponentWithComponentFactoryResolver(\"red\");\n      });\n      i0.ɵɵtext(9, \" Add Red Component \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"div\", null, 5);\n      i0.ɵɵelement(12, \"router-outlet\");\n    }\n  },\n  directives: [i2.RouterOutlet],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhcHAuY29tcG9uZW50LnNjc3MifQ== */\"]\n});","map":{"version":3,"sources":["/Users/nao/nodejs/angular-dynamic-import/src/app/app.component.ts","/Users/nao/nodejs/angular-dynamic-import/src/app/app.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, ComponentFactory, ComponentFactoryResolver, OnInit, ViewChild, ViewContainerRef } from '@angular/core';\nimport { WidgetService } from './services/widget.service';\nimport { BlueComponent } from './blue/blue.component';\nimport { RedComponent } from './red/red.component';\nimport { YellowComponent } from './yellow/yellow.component';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit {\n  blueFactory!: ComponentFactory<BlueComponent>;\n  redFactory!: ComponentFactory<RedComponent>;\n  yellowFactory!: ComponentFactory<YellowComponent>;\n  @ViewChild('dynamic', { read: ViewContainerRef }) viewContainerRef!: ViewContainerRef;\n\n\n  constructor(\n    private widgetService: WidgetService,\n    private resolver: ComponentFactoryResolver\n  ) {}\n\n  ngOnInit(): void {\n    this.listWidgets()\n\n    // const aaa = this.loadDynamicComponent('blue');\n    // console.log('aaa:', aaa)\n\n    this.blueFactory = this.resolver.resolveComponentFactory(BlueComponent);\n    this.redFactory = this.resolver.resolveComponentFactory(RedComponent);\n    this.yellowFactory = this.resolver.resolveComponentFactory(YellowComponent);\n  }\n\n  listWidgets() {\n    this.widgetService.listWidgets('assets/widgets.json').subscribe(data => {\n      console.log(data)\n    });\n  }\n\n  loadDynamicComponentWithComponentFactoryResolver(type: string): void {\n    switch (type) {\n      case \"blue\":\n        this.viewContainerRef.createComponent(this.blueFactory);\n        break;\n      case \"red\":\n        this.viewContainerRef.createComponent(this.redFactory);\n        break;\n      case \"yellow\":\n        this.viewContainerRef.createComponent(this.yellowFactory);\n        break;\n      default:\n        return\n    }\n\n  }\n\n  // loadDynamicComponent(type: string): any {\n  async loadDynamicComponent(type: string): Promise<any> {\n    // const widgetModule = await import(`./${type}/${type}.module`)\n    // return new widgetModule.BlueModule.BlueComponent\n\n    // const widgetModule = await import(`./blue/blue.module`)\n    const widgetModule = await import(`./blue/blue.component`)\n    const hoge = new widgetModule.BlueComponent\n  }\n\n}\n\n","<div class=\"m-24 flex flex-wrap gap-x-2 justify-center\">\n  <button\n    class=\"\n      py-2\n      px-4\n      border border-transparent\n      shadow-sm\n      text-sm\n      font-medium\n      rounded-md\n      text-white\n      bg-gray-500\n      hover:bg-gray-700\n    \"\n    (click)=\"loadDynamicComponent('blue')\"\n  >\n    Add Random Component\n  </button>\n</div>\n\n<div class=\"m-24 flex flex-wrap gap-x-2 justify-center\">\n  <button\n    class=\"\n      py-2\n      px-4\n      border border-transparent\n      shadow-sm\n      text-sm\n      font-medium\n      rounded-md\n      text-white\n      bg-blue-400\n      hover:bg-blue-600\n    \"\n    (click)=\"loadDynamicComponentWithComponentFactoryResolver('blue')\"\n  >\n    Add Blue Component\n  </button>\n\n  <button\n    class=\"\n      py-2\n      px-4\n      border border-transparent\n      shadow-sm\n      text-sm\n      font-medium\n      rounded-md\n      text-white\n      bg-yellow-400\n      hover:bg-yellow-600\n    \"\n    (click)=\"loadDynamicComponentWithComponentFactoryResolver('yellow')\"\n  >\n    Add Yellow Component\n  </button>\n\n  <button\n    class=\"\n      py-2\n      px-4\n      border border-transparent\n      shadow-sm\n      text-sm\n      font-medium\n      rounded-md\n      text-white\n      bg-red-400\n      hover:bg-red-600\n    \"\n    (click)=\"loadDynamicComponentWithComponentFactoryResolver('red')\"\n  >\n    Add Red Component\n  </button>\n</div>\n\n<div #dynamic></div>\n\n<router-outlet></router-outlet>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}